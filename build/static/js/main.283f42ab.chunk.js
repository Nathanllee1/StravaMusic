(this.webpackJsonpstravamusic=this.webpackJsonpstravamusic||[]).push([[0],{15:function(e,t,a){},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(1),c=a.n(n),o=a(8),i=a.n(o),s=(a(15),a(2)),l=a.n(s),u=a(4),d=a(3),f=(a(17),a.p+"static/media/demo.c1d4f23b.png"),h=a.p+"static/media/Spotify_Logo_RGB_White.f48fb565.png",g=a(7),p=a(9);var j=function(e){var t=new Date(Date.parse(e.activity.start_date_local));return Object(r.jsxs)("div",{id:"card",children:[Object(r.jsx)("h2",{onClick:function(){return window.location="https://strava.com/activities/"+e.id},id:"header",children:e.activity.name}),Object(r.jsx)("p",{children:t.toLocaleDateString()}),Object(r.jsx)("div",{id:"stats",children:Object(r.jsxs)("p",{children:[Object(r.jsx)("span",{style:{color:"grey"},children:"Distance:"})," ",100*Math.round(e.activity.distance/1609+Number.EPSILON)/100," miles  \xa0 \xa0 \xa0",Object(r.jsx)("span",{style:{color:"grey"},children:"Elevation Climbed:"})," ",100*Math.round(3.28084*e.activity.total_elevation_gain+Number.EPSILON)/100," feet"]})}),Object(r.jsx)("br",{}),Object(r.jsx)("div",{id:"songList",children:e.imageList}),Object(r.jsx)("br",{}),Object(r.jsx)("span",{id:"songList",children:e.songList})]},e.id)};var b=function(e){var t=Object(n.useState)({}),a=Object(d.a)(t,2),c=a[0],o=a[1],i=Object(n.useState)([]),s=Object(d.a)(i,2),f=s[0],h=s[1],b=Object(n.useState)("5TUZhrb8UaaA76NhzZax2Z"),O=Object(d.a)(b,2),S=O[0],v=O[1];Object(n.useEffect)((function(){if(c){localStorage.getItem("stravaInfo")?o(JSON.parse(localStorage.getItem("stravaInfo"))):fetch("https://www.strava.com/api/v3/athlete?access_token=".concat(localStorage.getItem("stravaTok")),{method:"GET",redirect:"follow"}).then((function(e){return e.text()})).then(function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Authorization Error"!==JSON.parse(t).message){e.next=4;break}return e.next=4,m();case 4:o(JSON.parse(t)),localStorage.setItem("stravaInfo",t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log("error",e)}));fetch("http://60d228aec15f.ngrok.io/getActivities/?id=10441589",{method:"GET",redirect:"follow"}).then((function(e){return e.text()})).then(function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,c,o,i,s,u,d,f,b,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),a=JSON.parse(t),n=[],c=0,o=Object.keys(a);case 4:if(!(c<o.length)){e.next=39;break}if(i=o[c],console.log(i),s=localStorage.getItem(i)){e.next=15;break}return e.next=11,x(i);case 11:s=e.sent,localStorage.setItem(i,JSON.stringify(s)),e.next=16;break;case 15:s=JSON.parse(s);case 16:u=[],d=[],f=Object(p.a)(a[i]),e.prev=19,O=l.a.mark((function e(){var t,a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=b.value,!(a=localStorage.getItem(t))){e.next=6;break}a=JSON.parse(a),e.next=15;break;case 6:return e.t0=JSON,e.next=9,w(t);case 9:if(e.t1=e.sent,!(a=e.t0.parse.call(e.t0,e.t1)).error||401!==a.error.status){e.next=14;break}return e.next=14,m();case 14:localStorage.setItem(t,JSON.stringify(a));case 15:a.album&&(u.push(Object(r.jsxs)("span",(n={id:a.id,className:S},Object(g.a)(n,"id",a.id),Object(g.a)(n,"children",[a.name,",\xa0 "]),n))),d.push(Object(r.jsx)("img",{id:a.id,onMouseOver:function(){return v(a.id)},src:a.album.images[1].url,alt:"songImage",width:80},a.id)));case 16:case"end":return e.stop()}}),e)})),f.s();case 22:if((b=f.n()).done){e.next=26;break}return e.delegateYield(O(),"t0",24);case 24:e.next=22;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(19),f.e(e.t1);case 31:return e.prev=31,f.f(),e.finish(31);case 34:console.log(d),n.push(Object(r.jsx)(j,{id:i,imageList:d,songList:u,activity:s}));case 36:c++,e.next=4;break;case 39:console.log(n),h(n);case 41:case"end":return e.stop()}}),e,null,[[19,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log("error",e)}))}}),[]);var m=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={method:"GET"},fetch("http://60d228aec15f.ngrok.io/refreshTokens/?id=".concat(localStorage.getItem("id")),t).then((function(e){return e.text()})).then((function(e){var t=JSON.parse(e);localStorage.setItem("stravaTok",t.stravaTok),localStorage.setItem("spotifyTok",t.spotTok)})).catch((function(e){return console.log("error",e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"GET",redirect:"follow"},e.next=3,fetch("https://www.strava.com/api/v3/activities/"+t+"?access_token="+localStorage.getItem("stravaTok"),a).then((function(e){return e.text()})).then((function(e){r=JSON.parse(e)})).catch((function(e){return console.log("error",e)}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new Headers).append("Authorization","Bearer "+localStorage.getItem("spotifyTok")),n={method:"GET",headers:a,redirect:"follow"},e.next=5,fetch("https://api.spotify.com/v1/tracks/"+t,n).then((function(e){return e.text()})).then((function(e){return r=e})).catch((function(e){return console.log("error",e)}));case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return console.log(f===[]),Object(r.jsxs)("div",{id:"appPage",children:[Object(r.jsx)("div",{id:"bar",children:Object(r.jsxs)("div",{id:"profile",children:[Object(r.jsxs)("p",{children:[c.firstname," ",c.lastname]}),Object(r.jsx)("img",{id:"profilePic",src:c.profile,alt:"profilepic"}),Object(r.jsx)("p",{id:"signout",onClick:function(){localStorage.clear(),window.location.reload(!1)},children:"Sign out"})]})}),Object(r.jsx)("div",{id:"cardList",children:0!==f.length?f:Object(r.jsx)("div",{id:"content",children:Object(r.jsx)("h2",{children:"Everything is setup, when you record an activity while listening to Spotify, it will show up here"})})})]})};var O=function(){var e=Object(n.useState)(),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(),i=Object(d.a)(o,2),s=i[0],g=i[1],p=Object(n.useState)(),j=Object(d.a)(p,2),O=(j[0],j[1]),S=Object(n.useState)(),v=Object(d.a)(S,2),m=v[0],x=v[1],w="http://60d228aec15f.ngrok.io";Object(n.useEffect)((function(){var e=new URL(window.location);if(O(e.origin),"strava"===localStorage.getItem("lastClicked")){var t=e.searchParams.get("code");t||(localStorage.clear(),window.location.reload(!1)),function(){var e=Object(u.a)(l.a.mark((function e(){var a,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new Headers).append("Content-Type","application/json"),n=JSON.stringify({strava:t}),c={method:"POST",headers:a,body:n,redirect:"follow"},e.next=6,fetch(w+"/authorizeStrava",c).then((function(e){return e.text()})).then((function(e){console.log(e);var t=JSON.parse(e);console.log(t),t.spotRef?(localStorage.setItem("stravaTok",t.stravaTok),localStorage.setItem("id",t.stravaId),localStorage.setItem("spotifyTok",t.spotTok),localStorage.setItem("lastClicked","signedIn"),x(Object(r.jsx)(b,{}))):(localStorage.setItem("stravaTok",t.stravaTok),localStorage.setItem("stravaRef",t.stravaRef),localStorage.setItem("id",t.stravaId),x(Object(r.jsxs)("div",{id:"content",children:[Object(r.jsx)("h1",{children:"Awesome! Link your Spotify account"}),Object(r.jsx)("div",{id:"spotify",onClick:y,children:Object(r.jsx)("img",{height:"24px",src:h,alt:"spotify"})})]})))})).catch((function(e){return console.log("error",e)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}else if("signedIn"===localStorage.getItem("lastClicked"))x(Object(r.jsx)(b,{}));else if("spotify"===localStorage.getItem("lastClicked")){var a=e.searchParams.get("code");localStorage.setItem("spotify",a),C()}else x(Object(r.jsxs)("div",{id:"content",children:[Object(r.jsxs)("h1",{children:["Put the songs you listened to on ",Object(r.jsx)("span",{style:{color:"#1DB954"},children:"Spotify"})," during your activities on ",Object(r.jsx)("span",{style:{color:"#fc5200"},children:"Strava"})]}),Object(r.jsx)("img",{width:"350",src:f,alt:"Demo"}),Object(r.jsx)("p",{children:"Once setup, the process is done completely automatically"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("h2",{children:"Start by connecting your Strava Account"}),Object(r.jsx)("p",{children:"Or if you've already signed up also click here"}),Object(r.jsx)("img",{id:"stravacon",src:"data:image/png;base64,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",onClick:k,alt:"stravaConnect"})]}));g(localStorage.getItem("spotify")),c(localStorage.getItem("strava"))}),[]);var k=function(){localStorage.setItem("lastClicked","strava"),window.location="http://www.strava.com/oauth/authorize?client_id=24406&response_type=code&redirect_uri="+window.location.origin+"/exchange_token&approval_prompt=force&scope=activity:read_all,activity:write"},y=function(){localStorage.setItem("lastClicked","spotify"),window.location="https://accounts.spotify.com/authorize?client_id=5a18a679262e4ac094c14cacfd5fd861&response_type=code&redirect_uri="+encodeURI(window.location.origin)+"&scope=user-read-private%20user-read-email%20user-read-recently-played&state=34fFs29kd09"},C=function(){var e=new Headers;e.append("Content-Type","application/json");var t=JSON.stringify({stravaTok:localStorage.getItem("stravaTok"),stravaRef:localStorage.getItem("stravaRef"),spotify:localStorage.getItem("spotify"),id:localStorage.getItem("id")});fetch(w+"/createuser",{method:"POST",headers:e,body:t,redirect:"follow"}).then((function(e){return e.text()})).then((function(e){console.log(e);var t=JSON.parse(e);localStorage.setItem("spotTok",t.spotTok),localStorage.setItem("lastClicked","signedIn"),x(Object(r.jsx)(b,{}))})).catch((function(e){return console.log("error",e)}))};return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{id:"debug",children:[Object(r.jsx)("button",{onClick:k,children:"Connect with strava"}),Object(r.jsx)("button",{onClick:y,children:"Connect with spotify"}),Object(r.jsxs)("p",{children:["Strava: ",a]}),Object(r.jsxs)("p",{children:["Spotify: ",s]}),Object(r.jsx)("button",{onClick:C,children:"Submit"}),Object(r.jsx)("button",{onClick:function(){return localStorage.clear()},children:"Clear"})]}),Object(r.jsx)("br",{}),m]})},S=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,19)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,c=t.getLCP,o=t.getTTFB;a(e),r(e),n(e),c(e),o(e)}))};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(O,{})}),document.getElementById("root")),S()}},[[18,1,2]]]);
//# sourceMappingURL=main.283f42ab.chunk.js.map